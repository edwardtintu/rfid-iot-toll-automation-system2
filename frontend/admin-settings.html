<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Settings - HTMS</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <aside class="sidebar">
    <div class="logo">
      <i class="fas fa-road"></i>
      <h2>HTMS</h2>
    </div>
    <nav class="nav-menu">
      <a href="index.html" class="nav-link"><i class="fas fa-chart-line"></i><span>Dashboard</span></a>
      <a href="readers.html" class="nav-link"><i class="fas fa-microchip"></i><span>Reader Trust</span></a>
      <a href="decisions.html" class="nav-link"><i class="fas fa-brain"></i><span>Decision Telemetry</span></a>
      <a href="blockchain.html" class="nav-link"><i class="fas fa-link"></i><span>Blockchain Audit</span></a>
      <a href="manual-entry.html" class="nav-link"><i class="fas fa-edit"></i><span>Manual Entry</span></a>
      <a href="toll-processing.html" class="nav-link"><i class="fas fa-exchange-alt"></i><span>Toll Processing</span></a>
      <a href="reader-management.html" class="nav-link"><i class="fas fa-cog"></i><span>Reader Management</span></a>
      <a href="admin-settings.html" class="nav-link active"><i class="fas fa-user-shield"></i><span>Admin Settings</span></a>
    </nav>
    <div class="sidebar-user">
      <div class="sidebar-user-avatar">A</div>
      <div class="sidebar-user-info">
        <h4 class="sidebar-user-name">Admin User</h4>
        <p class="sidebar-user-role">System Administrator</p>
      </div>
    </div>
  </aside>

  <main class="main-content">
    <header class="top-header">
      <div class="header-left">
        <button class="menu-toggle"><i class="fas fa-bars"></i></button>
        <h1>Admin Settings</h1>
      </div>
      <div class="header-right">
        <div class="status-indicator">
          <i class="fas fa-circle"></i>
          <span id="backend-status">Connected</span>
        </div>
        <div class="user-profile">
          <i class="fas fa-user-circle"></i>
          <span>Admin</span>
        </div>
      </div>
    </header>

    <section class="data-section">
      <div class="row">
        <div class="col-md-12">
          <div class="card">
            <div class="card-header">
              <h2><i class="fas fa-user-shield"></i> Admin API Key</h2>
            </div>
            <div class="card-body">
              <p>Set the admin API key once to unlock protected actions in the UI.</p>
              <form id="admin-key-form">
                <div class="form-row">
                  <div class="form-group">
                    <label for="admin-key">Admin API Key</label>
                    <input type="password" id="admin-key" class="form-control" placeholder="Enter admin API key" required>
                  </div>
                </div>
                <button type="submit" class="btn btn-primary">
                  <i class="fas fa-save"></i> Save Key
                </button>
                <button type="button" class="btn btn-outline" id="clear-key">
                  <i class="fas fa-trash"></i> Clear Key
                </button>
              </form>
              <div id="admin-key-result" class="mt-3"></div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <script src="js/common.js"></script>
  <script>
    document.querySelector('.menu-toggle').addEventListener('click', function() {
      document.querySelector('.sidebar').classList.toggle('collapsed');
      document.querySelector('.main-content').classList.toggle('sidebar-collapsed');
    });

    const input = document.getElementById('admin-key');
    const result = document.getElementById('admin-key-result');

    const stored = localStorage.getItem('htms_admin_key');
    if (stored) {
      input.value = stored;
    }

    document.getElementById('admin-key-form').addEventListener('submit', function(e) {
      e.preventDefault();
      localStorage.setItem('htms_admin_key', input.value);
      result.innerHTML = `
        <div class="alert alert-success">
          <i class="fas fa-check-circle"></i> Admin key saved.
        </div>
      `;
    });

    document.getElementById('clear-key').addEventListener('click', function() {
      localStorage.removeItem('htms_admin_key');
      input.value = '';
      result.innerHTML = `
        <div class="alert alert-info">
          <i class="fas fa-info-circle"></i> Admin key cleared.
        </div>
      `;
    });

    const style = document.createElement('style');
    style.textContent = `
      .form-row { display: flex; gap: 20px; margin-bottom: 20px; }
      .form-group { flex: 1; margin-bottom: 16px; }
      .form-group label { display: block; margin-bottom: 6px; font-weight: 500; color: var(--text-primary); }
      .form-control { width: 100%; padding: 12px 16px; border: 1px solid var(--border); border-radius: 10px; font-size: 14px; transition: var(--transition); background: var(--bg-surface); color: var(--text-primary); }
      .form-control:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(15, 118, 110, 0.2); }
      .alert { padding: 16px; border-radius: 10px; margin: 16px 0; display: flex; align-items: center; gap: 10px; }
      .alert-success { background: rgba(22, 163, 74, 0.12); border: 1px solid var(--success); color: var(--success); }
      .alert-info { background: rgba(14, 165, 233, 0.12); border: 1px solid var(--info); color: var(--info); }
      .mt-3 { margin-top: 16px; }
    `;
    document.head.appendChild(style);
  </script>
</body>
</html>
